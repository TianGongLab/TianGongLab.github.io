<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Microsoft Hyper-V 虚拟 TPM 设备漏洞分析 | 天工实验室</title>
<meta name="keywords" content="Microsoft, Hyper-V, TPM">
<meta name="description" content="Microsoft Hyper-V 虚拟 TPM 设备漏洞分析 一、漏洞描述 2023年10月微软发布的安全更新中，修复了2个由笔者报送的Hyper-V虚拟TPM设备漏洞。本次修复的Hyper-V虚拟TPM组件的漏洞可以通过远程访问虚拟机的方式触发漏洞，造成宿主机拒绝服务或者远程代码执行，对宿主机上的其他虚拟机或业务造成损失。
二、背景介绍 Hyper-V的虚拟TPM组件旨在为虚拟机提供模拟的TPM设备，虚拟TPM设备可以为依赖TPM设备的服务或者操作系统（例如Windows 11）提供支持。
漏洞位于vmsp.exe进程中的TpmEngUM.dll二进制文件中，本次介绍的两个虚拟TPM组件的漏洞就是位于TpmEngUM.dll这个二进制文件中。
vmsp.exe进程与vmwp.exe进程相似，都是一个虚拟机实例启动一个进程。但是不同的是vmsp.exe进程是隔离用户模式(IUM)进程，也就是说vmsp.exe进程无法在windows用户态下被正常attach。所以在调试上，针对vmsp.exe进程的调试就需要额外的“手脚”，这里我们引用Quarkslab博客的文章（https://blog.quarkslab.com/debugging-windows-isolated-user-mode-ium-processes.html），感兴趣的读者可以去了解并实践下，这里不做讨论。
三、环境搭建 虚拟TPM组件漏洞的触发需要在Hyper-V虚拟机设置中的“安全”设置中，勾选“启用受信任的平台模块”。
四、漏洞分析CVE-2023-36717 该漏洞是一个拒绝服务漏洞，当这个漏洞被触发时会导致宿主机vmsp.exe进程进入死循环，并占用大量CPU计算资源。由于vmsp.exe进程是IUM进程，所以当漏洞被触发后，管理员无法从用户态结束掉这个进程，这种情况下除非重启宿主机操作系统否则计算资源一直无法被释放。
这个漏洞位于TpmEngUM!TPM2_ECDH_KeyGen函数中。
__int64 __fastcall TPM2_ECDH_KeyGen(unsigned int *a1, __int64 a2) { OBJECT *v3; // rax OBJECT *v4; // rsi unsigned int v5; // eax unsigned int v6; // ebx unsigned __int16 v8[28]; // [rsp&#43;20h] [rbp-58h] BYREF v3 = ObjectGet(*a1); v4 = v3; if ( v3-&gt;public_type != 0x23 || (v3-&gt;public_objectAttributes &amp; 0x10000) != 0 || (v3-&gt;public_objectAttributes &amp; 0x20000) == 0 ) { return 0x19Ci64; } while ( !">
<meta name="author" content="hongzhenhao">
<link rel="canonical" href="http://localhost:1313/blog/tiangongarticle002/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.9b0c42f9222bc665b5845e6199fc07fd87b025125d3366cc5f873b0f54ca8481.css" integrity="sha256-mwxC&#43;SIrxmW1hF5hmfwH/YewJRJdM2bMX4c7D1TKhIE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="http://localhost:1313/blog/tiangongarticle002/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="天工实验室 (Alt + H)">
                <img src="http://localhost:1313/logo/logo3.png" alt="" aria-label="logo"
                    height="100" style="margin-top: 15px;">
            </a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://poc.qianxin.com/home" title="破壳官网">
                    <span>破壳官网</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">主页</a>&nbsp;»&nbsp;<a href="http://localhost:1313/blog/">博客</a></div>
    <h1 class="post-title entry-hint-parent">
      Microsoft Hyper-V 虚拟 TPM 设备漏洞分析
    </h1>
    <div class="post-meta"><span title='2023-10-25 00:00:00 +0000 UTC'>2023年10月25日</span>&nbsp;·&nbsp;3 分钟&nbsp;·&nbsp;hongzhenhao

</div>
  </header>

  <div class="author">
    <div class="author_avatar">
      <img src="/authors/hongzhenhao.jpg" alt="hongzhenhao">
    </div>
    <div class="author_info">
      <span class="author_id">hongzhenhao</span>
      <p class="author_description">微软 MSRC 全球最具价值安全精英榜上榜者、BlackHat USA 世界黑帽大会 Speaker</p>
    </div>
  </div>
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/microsoft/">Microsoft</a></li>
      <li><a href="http://localhost:1313/tags/hyper-v/">Hyper-V</a></li>
      <li><a href="http://localhost:1313/tags/tpm/">TPM</a></li>
    </ul><br/> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#microsoft-hyper-v-%e8%99%9a%e6%8b%9f-tpm-%e8%ae%be%e5%a4%87%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90" aria-label="Microsoft Hyper-V 虚拟 TPM 设备漏洞分析">Microsoft Hyper-V 虚拟 TPM 设备漏洞分析</a><ul>
                        
                <li>
                    <a href="#%e4%b8%80%e6%bc%8f%e6%b4%9e%e6%8f%8f%e8%bf%b0" aria-label="一、漏洞描述">一、漏洞描述</a></li>
                <li>
                    <a href="#%e4%ba%8c%e8%83%8c%e6%99%af%e4%bb%8b%e7%bb%8d" aria-label="二、背景介绍">二、背景介绍</a></li>
                <li>
                    <a href="#%e4%b8%89%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba" aria-label="三、环境搭建">三、环境搭建</a></li>
                <li>
                    <a href="#%e5%9b%9b%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90cve-2023-36717" aria-label="四、漏洞分析CVE-2023-36717">四、漏洞分析CVE-2023-36717</a></li>
                <li>
                    <a href="#%e4%ba%94%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90cve-2023-36718" aria-label="五、漏洞分析CVE-2023-36718">五、漏洞分析CVE-2023-36718</a></li>
                <li>
                    <a href="#%e5%85%ad%e6%80%bb%e7%bb%93" aria-label="六、总结">六、总结</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="microsoft-hyper-v-虚拟-tpm-设备漏洞分析">Microsoft Hyper-V 虚拟 TPM 设备漏洞分析<a hidden class="anchor" aria-hidden="true" href="#microsoft-hyper-v-虚拟-tpm-设备漏洞分析">#</a></h1>
<h2 id="一漏洞描述">一、漏洞描述<a hidden class="anchor" aria-hidden="true" href="#一漏洞描述">#</a></h2>
<p>2023年10月微软发布的安全更新中，修复了2个由笔者报送的Hyper-V虚拟TPM设备漏洞。本次修复的Hyper-V虚拟TPM组件的漏洞可以通过远程访问虚拟机的方式触发漏洞，造成宿主机拒绝服务或者远程代码执行，对宿主机上的其他虚拟机或业务造成损失。</p>
<!-- raw HTML omitted -->
<h2 id="二背景介绍">二、背景介绍<a hidden class="anchor" aria-hidden="true" href="#二背景介绍">#</a></h2>
<p>Hyper-V的虚拟TPM组件旨在为虚拟机提供模拟的TPM设备，虚拟TPM设备可以为依赖TPM设备的服务或者操作系统（例如Windows 11）提供支持。</p>
<p>漏洞位于<code>vmsp.exe</code>进程中的<code>TpmEngUM.dll</code>二进制文件中，本次介绍的两个虚拟TPM组件的漏洞就是位于<code>TpmEngUM.dll</code>这个二进制文件中。</p>
<p><code>vmsp.exe</code>进程与<code>vmwp.exe</code>进程相似，都是一个虚拟机实例启动一个进程。但是不同的是<code>vmsp.exe</code>进程是隔离用户模式(IUM)进程，也就是说<code>vmsp.exe</code>进程无法在windows用户态下被正常attach。所以在调试上，针对<code>vmsp.exe</code>进程的调试就需要额外的“手脚”，这里我们引用Quarkslab博客的文章（https://blog.quarkslab.com/debugging-windows-isolated-user-mode-ium-processes.html），感兴趣的读者可以去了解并实践下，这里不做讨论。</p>
<h2 id="三环境搭建">三、环境搭建<a hidden class="anchor" aria-hidden="true" href="#三环境搭建">#</a></h2>
<p>虚拟TPM组件漏洞的触发需要在Hyper-V虚拟机设置中的“安全”设置中，勾选“启用受信任的平台模块”。</p>
<p><img loading="lazy" src="/attachments/2023-10-25-microsoft-hyper-vtpm/0c7d620e-97ff-45cc-a12f-b4c66a317e2a.png" alt=""  />
</p>
<h2 id="四漏洞分析cve-2023-36717">四、漏洞分析CVE-2023-36717<a hidden class="anchor" aria-hidden="true" href="#四漏洞分析cve-2023-36717">#</a></h2>
<p>该漏洞是一个拒绝服务漏洞，当这个漏洞被触发时会导致宿主机<code>vmsp.exe</code>进程进入死循环，并占用大量CPU计算资源。由于<code>vmsp.exe</code>进程是IUM进程，所以当漏洞被触发后，管理员无法从用户态结束掉这个进程，这种情况下除非重启宿主机操作系统否则计算资源一直无法被释放。</p>
<p>这个漏洞位于<code>TpmEngUM!TPM2_ECDH_KeyGen</code>函数中。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">__int64</span> <span style="color:#a6e22e">__fastcall</span> <span style="color:#a6e22e">TPM2_ECDH_KeyGen</span>(<span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">a1</span>, <span style="color:#a6e22e">__int64</span> <span style="color:#a6e22e">a2</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">OBJECT</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">v3</span>; <span style="color:#75715e">// rax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">OBJECT</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">v4</span>; <span style="color:#75715e">// rsi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">v5</span>; <span style="color:#75715e">// eax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">v6</span>; <span style="color:#75715e">// ebx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">v8</span>[<span style="color:#ae81ff">28</span>]; <span style="color:#75715e">// [rsp+20h] [rbp-58h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">v3</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ObjectGet</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">a1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">v4</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">v3</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">v3</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_type</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x23</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">||</span> (<span style="color:#a6e22e">v3</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_objectAttributes</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x10000</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">||</span> (<span style="color:#a6e22e">v3</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_objectAttributes</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x20000</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0x19C</span><span style="color:#a6e22e">i64</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> ( <span style="color:#f92672">!</span>(<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span>)<span style="color:#a6e22e">cpri__GetEphemeralEcc</span>(
</span></span><span style="display:flex;"><span>                               (<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)(<span style="color:#a6e22e">a2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">104</span>),
</span></span><span style="display:flex;"><span>                               <span style="color:#a6e22e">v8</span>,
</span></span><span style="display:flex;"><span>                               <span style="color:#a6e22e">v4</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_parameters_Detail_keyBits</span>) )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(<span style="color:#a6e22e">_WORD</span> <span style="color:#f92672">*</span>)(<span style="color:#a6e22e">a2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x66</span>) <span style="color:#f92672">=</span> <span style="color:#a6e22e">TPMS_ECC_POINT_Marshal</span>((<span style="color:#a6e22e">_BYTE</span> <span style="color:#f92672">*</span>)(<span style="color:#a6e22e">a2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">104</span>), <span style="color:#ae81ff">0</span><span style="color:#a6e22e">i64</span>, <span style="color:#ae81ff">0</span><span style="color:#a6e22e">i64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">v5</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptEccPointMultiply</span>(
</span></span><span style="display:flex;"><span>           (<span style="color:#a6e22e">_WORD</span> <span style="color:#f92672">*</span>)(<span style="color:#a6e22e">a2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>),
</span></span><span style="display:flex;"><span>           <span style="color:#a6e22e">v4</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_parameters_Detail_keyBits</span>,
</span></span><span style="display:flex;"><span>           <span style="color:#a6e22e">v8</span>,
</span></span><span style="display:flex;"><span>           (<span style="color:#a6e22e">__int64</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">v4</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_unique_ecc_x</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">v6</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">v5</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">v5</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xA7</span> )
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">v5</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x154</span> )
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">goto</span> <span style="color:#a6e22e">LABEL_9</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">v6</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">156</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">LABEL_9</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span><span style="color:#a6e22e">v6</span> )
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(<span style="color:#a6e22e">_WORD</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">a2</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TPMS_ECC_POINT_Marshal</span>((<span style="color:#a6e22e">_BYTE</span> <span style="color:#f92672">*</span>)(<span style="color:#a6e22e">a2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">0</span><span style="color:#a6e22e">i64</span>, <span style="color:#ae81ff">0</span><span style="color:#a6e22e">i64</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v6</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>在<code>TpmEngUM!TPM2_ECDH_KeyGen</code>函数中，<code>v4-&gt;public_unique_ecc_x</code>成员可以从Guest中被控制，如果<code>v4-&gt;public_unique_ecc_x</code>成员是一个NULL ECC Point的情况下（<code>TPM2B_ECC_PARAMETER.size</code>为0x00,并且<code>TPM2B_ECC_PARAMETER.buffer</code>数组被0填充），<code>TpmEngUM!CryptEccPointMultiply</code>会一直返回错误码0x154，并不停的循环调用<code>TpmEngUM!CryptEccPointMultiply</code>函数，最终造成vmsp.exe进程死循环，导致宿主机拒绝服务。</p>
<h2 id="五漏洞分析cve-2023-36718">五、漏洞分析CVE-2023-36718<a hidden class="anchor" aria-hidden="true" href="#五漏洞分析cve-2023-36718">#</a></h2>
<p>该漏洞是远程代码执行漏洞，当这个漏洞被触发时会使用未初始化的栈空间变量。这个漏洞位于<code>TpmEngUM!CryptSecretEncrypt</code>函数中。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">__int64</span> <span style="color:#a6e22e">__fastcall</span> <span style="color:#a6e22e">CryptSecretEncrypt</span>(<span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">a1</span>, <span style="color:#a6e22e">_BYTE</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">a2_plabel</span>, <span style="color:#a6e22e">__int64</span> <span style="color:#a6e22e">a3</span>, <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">a4</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">v7</span>; <span style="color:#75715e">// ebx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">OBJECT</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">v8_obj</span>; <span style="color:#75715e">// rax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">OBJECT</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">v9_obj</span>; <span style="color:#75715e">// rdi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">DigestSize</span>; <span style="color:#75715e">// ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">public_parameters_Detail_keyBits</span>; <span style="color:#75715e">// cx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">public_nameAlg</span>; <span style="color:#75715e">// cx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">v14</span>; <span style="color:#75715e">// [rsp+40h] [rbp-C0h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">v15</span>[<span style="color:#ae81ff">28</span>]; <span style="color:#75715e">// [rsp+48h] [rbp-B8h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">v16</span>[<span style="color:#ae81ff">56</span>]; <span style="color:#75715e">// [rsp+80h] [rbp-80h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">__int16</span> <span style="color:#a6e22e">v17_Z_eccpointaftermul</span>[<span style="color:#ae81ff">56</span>]; <span style="color:#75715e">// [rsp+F0h] [rbp-10h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">v7</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">v8_obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ObjectGet</span>(<span style="color:#a6e22e">a1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">v9_obj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">v8_obj</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>......
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DigestSize</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cpri__GetDigestSize</span>(<span style="color:#a6e22e">v8_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_nameAlg</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>(<span style="color:#a6e22e">_WORD</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">a3</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">DigestSize</span>;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>......
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_type</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>......
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_type</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x23</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>......
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">public_parameters_Detail_keyBits</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_parameters_Detail_keyBits</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">v14</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">a4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( (<span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#a6e22e">cpri__EccIsPointOnCurve</span>(
</span></span><span style="display:flex;"><span>                         <span style="color:#a6e22e">public_parameters_Detail_keyBits</span>,
</span></span><span style="display:flex;"><span>                         (<span style="color:#a6e22e">__int64</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_unique_ecc_x</span>) )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">cpri__GetEphemeralEcc</span>((<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">v16</span>, (<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">v15</span>, <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_parameters_Detail_keyBits</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">*</span><span style="color:#a6e22e">a4</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">TPMS_ECC_POINT_Marshal</span>(<span style="color:#a6e22e">v16</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">v14</span>, <span style="color:#ae81ff">0</span><span style="color:#a6e22e">i64</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( (<span style="color:#a6e22e">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#a6e22e">CryptEccPointMultiply</span>(
</span></span><span style="display:flex;"><span>                           <span style="color:#a6e22e">v17_Z_eccpointaftermul</span>,
</span></span><span style="display:flex;"><span>                           <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_parameters_Detail_keyBits</span>,
</span></span><span style="display:flex;"><span>                           (<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">v15</span>,
</span></span><span style="display:flex;"><span>                           (<span style="color:#a6e22e">__int64</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_unique_ecc_x</span>) )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">v7</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x9C</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">BitIsSet</span>((<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span>)<span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_nameAlg</span>, (<span style="color:#a6e22e">__int64</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">g_toTest</span>, <span style="color:#ae81ff">9</span><span style="color:#a6e22e">u</span>) )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">public_nameAlg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_nameAlg</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">public_nameAlg</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x10</span> )
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">TestAlgorithm</span>(<span style="color:#a6e22e">public_nameAlg</span>, <span style="color:#ae81ff">0</span><span style="color:#a6e22e">i64</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">cpri__KDFe</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_nameAlg</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">v17_Z_eccpointaftermul</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">a2_plabel</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">v16</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">v9_obj</span><span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">public_unique_ecc_x</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> <span style="color:#f92672">*</span>(<span style="color:#a6e22e">unsigned</span> <span style="color:#a6e22e">__int16</span> <span style="color:#f92672">*</span>)<span style="color:#a6e22e">a3</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#a6e22e">_BYTE</span> <span style="color:#f92672">*</span>)(<span style="color:#a6e22e">a3</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0x9C</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v7</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>上面代码中的<code>v17_Z_eccpointaftermul</code>是一个栈上的数组（也可能是个结构体），<code>v17_Z_eccpointaftermul</code>的大小是0x70字节。代码中的<code>v9_obj-&gt;public_unique_ecc_x</code>成员可以从Guest中被控制，当<code>v9_obj-&gt;public_unique_ecc_x</code>成员是一个NULL ECC Point的情况下<code>（TPM2B_ECC_PARAMETER.size</code>为0x00,并且<code>TPM2B_ECC_PARAMETER.buffer</code>数组被0填充），<code>TpmEngUM!CryptEccPointMultiply</code>函数会返回一个错误码并将v7设置为0x9C。</p>
<p>设置完v7的值之后，程序继续走到要调用<code>TpmEngUM!cpri__KDFe</code>函数这里，此时<code>v17_Z_eccpointaftermul</code>是一个栈上未初始化的数组，并作为<code>TpmEngUM!cpri__KDFe</code>函数的第二参数进入到之后的<code>TpmEngUM!cpri__KDFe</code>函数的代码流程里。</p>
<p>在<code>TpmEngUM!cpri__KDFe</code>函数后续的代码流程中，使用了未初始化的栈上的数据，导致越界读或者内存损坏。下面是崩溃时的现场：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>(<span style="color:#ae81ff">4</span><span style="color:#a6e22e">afc</span>.<span style="color:#ae81ff">2</span><span style="color:#a6e22e">f4c</span>)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Access</span> <span style="color:#a6e22e">violation</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">code</span> <span style="color:#a6e22e">c0000005</span> (<span style="color:#a6e22e">first</span> <span style="color:#a6e22e">chance</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">First</span> <span style="color:#a6e22e">chance</span> <span style="color:#a6e22e">exceptions</span> <span style="color:#a6e22e">are</span> <span style="color:#a6e22e">reported</span> <span style="color:#a6e22e">before</span> <span style="color:#a6e22e">any</span> <span style="color:#a6e22e">exception</span> <span style="color:#a6e22e">handling</span>.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">This</span> <span style="color:#a6e22e">exception</span> <span style="color:#a6e22e">may</span> <span style="color:#a6e22e">be</span> <span style="color:#a6e22e">expected</span> <span style="color:#a6e22e">and</span> <span style="color:#a6e22e">handled</span>.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">SymCryptSha512AppendBlocks_ull</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0xa7</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00007</span><span style="color:#a6e22e">ffb</span><span style="color:#e6db74">`38d9a42f 4d8b41f0        mov     r8,qword ptr [r9-10h] ds:00000000`</span><span style="color:#ae81ff">00153</span><span style="color:#a6e22e">ffe</span><span style="color:#f92672">=????????????????</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">k</span>
</span></span><span style="display:flex;"><span> <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Child</span><span style="color:#f92672">-</span><span style="color:#a6e22e">SP</span>          <span style="color:#a6e22e">RetAddr</span>           <span style="color:#a6e22e">Call</span> <span style="color:#a6e22e">Site</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014ec80 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d99e01</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">SymCryptSha512AppendBlocks_ull</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0xa7</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014eed0 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d99e59</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">SymCryptSha512Append</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x95</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">02</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014ef10 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d87724</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">SymCryptSha384Append</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x9</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014ef40 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d66cd7</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">cpri__KDFe</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x1a4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">04</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014f110 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d7c7cd</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">CryptSecretEncrypt</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x143</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014f2c0 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d70a54</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">TPM2_MakeCredential</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x7d</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">06</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014f340 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d61c54</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">CommandDispatcher</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0xa78</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">07</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014f420 00007ffb`</span><span style="color:#ae81ff">38</span><span style="color:#a6e22e">d61313</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">ExecuteCommand</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x460</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">08</span> <span style="color:#ae81ff">00000000</span><span style="color:#e6db74">`0014f530 00000001`</span><span style="color:#ae81ff">400</span><span style="color:#a6e22e">c3862</span> <span style="color:#a6e22e">TpmEngUM</span><span style="color:#f92672">!</span><span style="color:#a6e22e">VTpmExecuteCommand</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x73</span>
</span></span></code></pre></div><h2 id="六总结">六、总结<a hidden class="anchor" aria-hidden="true" href="#六总结">#</a></h2>
<p>借助此文简单的介绍了下Hyper-V虚拟TPM组件的两个漏洞，可以发现这两个漏洞都是Hyper-V虚拟TPM组件在处理Guest数据时发生了错误导致宿主机进程受到了影响。通过本文帮助读者更好地理解虚拟TPM组件漏洞的成因，以及希望能够在TPM组件的漏洞挖掘工作中帮到大家。</p>


  </div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/blog/tiangongarticle003/">
    <span class="title">« 上一页</span>
    <br>
    <span>Windows内核竞态条件漏洞研究</span>
  </a>
  <a class="next" href="http://localhost:1313/blog/tiangongarticle001/">
    <span class="title">下一页 »</span>
    <br>
    <span>CVE-2023-0179 Linux内核提权</span>
  </a>
</nav>





  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://poc.qianxin.com/home">天工实验室</a></span>
        

    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
